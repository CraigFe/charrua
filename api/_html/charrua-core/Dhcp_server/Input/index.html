<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"><head><title>Input (charrua-core.Dhcp_server.Input)</title><link rel="stylesheet" href="../../../odoc.css"/><meta charset="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1.0"/><meta name="generator" content="doc-ock-html v1.0.0-1-g1fc9bf0"/></head><body><nav id="top"><a href="../index.html">Up</a> &mdash; <span class="package">package <a href="../../index.html">charrua-core</a></span></nav><header><h1><span class="keyword">Module</span> <span class="module-path">Dhcp_server.Input</span></h1></header><p>The logic for handling a DHCP input packet is pure, the module does not
perform any IO, it only returns a possible reply packet or event to be
logged.</p><p>A typical server main loop would do its own IO for receiving a packet,
then input with <a href="index.html#val-input_pkt">Input.input_pkt</a> and send out the resulting reply.</p><div class="spec type" id="type-result"><a href="#type-result" class="anchor"></a><div class="def type"><code><span class="keyword">type </span>result</code><code></code><code><span class="keyword"> = </span></code><table class="variant"><tr id="type-result.Silence" class="anchored"><td class="def constructor"><a href="#type-result.Silence" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Silence</span></code></td><td class="doc"><p>(** Input packet didn't belong to us, normal nop event. *)</p></td></tr><tr id="type-result.Update" class="anchored"><td class="def constructor"><a href="#type-result.Update" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Update</span><span class="keyword"> of </span><a href="../Lease/index.html#type-database">Lease.database</a></code></td><td class="doc"><p>(** Lease database update. *)</p></td></tr><tr id="type-result.Reply" class="anchored"><td class="def constructor"><a href="#type-result.Reply" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Reply</span><span class="keyword"> of </span><a href="../../Dhcp_wire/index.html#type-pkt">Dhcp_wire.pkt</a><span class="keyword"> * </span><a href="../Lease/index.html#type-database">Lease.database</a></code></td><td class="doc"><p>(** Reply packet to be sent back and the corresponding lease database to be
used in case the sent of the reply pkt is successfull *)</p></td></tr><tr id="type-result.Warning" class="anchored"><td class="def constructor"><a href="#type-result.Warning" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Warning</span><span class="keyword"> of </span>string</code></td><td class="doc"><p>(** An odd event, could be logged. *)</p></td></tr><tr id="type-result.Error" class="anchored"><td class="def constructor"><a href="#type-result.Error" class="anchor"></a><code><span class="keyword">| </span></code><code><span class="constructor">Error</span><span class="keyword"> of </span>string</code></td><td class="doc"><p>(** Input packet is invalid, or some other error ocurred. *)</p></td></tr></table><code></code></div><div class="doc"><p>The result of <code class="code">input_pkt</code>.</p></div></div><div class="spec val" id="val-for_us"><a href="#val-for_us" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>for_us : <a href="../Config/index.html#type-t">Config.t</a> <span class="keyword">&#8209;&gt;</span> <a href="../../Dhcp_wire/index.html#type-pkt">Dhcp_wire.pkt</a> <span class="keyword">&#8209;&gt;</span> bool</code></div><div class="doc"><p>Check the packet headers, true if the packet is destined for us.</p></div></div><div class="spec val" id="val-input_pkt"><a href="#val-input_pkt" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>input_pkt : <a href="../Config/index.html#type-t">Config.t</a> <span class="keyword">&#8209;&gt;</span> <a href="../Lease/index.html#type-database">Lease.database</a> <span class="keyword">&#8209;&gt;</span> <a href="../../Dhcp_wire/index.html#type-pkt">Dhcp_wire.pkt</a> <span class="keyword">&#8209;&gt;</span> int32 <span class="keyword">&#8209;&gt;</span> <a href="index.html#type-result">result</a></code></div><div class="doc"><p><code class="code">input_pkt config lease_db pkt time</code> Inputs packet <code class="code">pkt</code>, lease_db
is the current lease database state, the resulting action should be
performed by the caller, normally a <code class="code">Reply</code> packet is returned and should be
sent back. <code class="code">time</code> is a int32 representing time as monotonic seconds.</p></div></div><div class="spec val" id="val-collect_replies_test"><a href="#val-collect_replies_test" class="anchor"></a><div class="def val"><code><span class="keyword">val </span>collect_replies_test : <a href="../Config/index.html#type-t">Config.t</a> <span class="keyword">&#8209;&gt;</span> Macaddr.t <span class="keyword">&#8209;&gt;</span> <a href="../../Dhcp_wire/index.html#type-option_code">Dhcp_wire.option_code</a> list <span class="keyword">&#8209;&gt;</span> <a href="../../Dhcp_wire/index.html#type-dhcp_option">Dhcp_wire.dhcp_option</a> list</code></div><div class="doc"><p>Internal function exported for regression tests. Don't use this.</p></div></div></body></html>